<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sebs DayZ Map</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">

<style>
html, body {
    margin: 0;
    height: 100%;
    overflow: hidden;
    background: #111;
    color: #fff;
    font-family: 'Segoe UI', Roboto, sans-serif;
}

/* ===== NAVBAR ===== */
.navbar-glass {
    backdrop-filter: blur(16px) saturate(180%);
    background-color: rgba(30,30,30,0.6);
    border-bottom: 2px solid #88ff00;
    box-shadow: 0 0 25px rgba(0,0,0,0.5);
    padding: 0.5rem 1rem;
    position: sticky;
    top: 0;
    z-index: 1000;
}

.navbar-brand {
    font-weight: 700;
    font-size: 1.4rem;
    color: #88ff00;
}

/* ===== VIEWPORT ===== */
#viewport {
    position: relative;
    width: 100%;
    height: calc(100vh - 120px);
    overflow: hidden;
    cursor: grab;
}
#viewport:active { cursor: grabbing; }

/* ===== MAP ===== */
#map-wrapper {
    position: absolute;
    width: 1500px;
    height: 1356px;
    transform-origin: 0 0;
    will-change: transform;
}

#map-container {
    width: 1500px;
    height: 1356px;
    background: url('CHERNOMAP.webp') no-repeat top left;
    background-size: contain;
}

/* ===== MARKERS ===== */
.marker {
    position: absolute;
    width: 16px;
    height: 16px;
    border-radius: 50%;
    transform: translate(-50%, -50%);
    cursor: pointer;
}

/* ===== TOOLTIP ===== */
#tooltip {
    position: fixed;
    background: rgba(0,0,0,0.9);
    padding: 6px 10px;
    border-radius: 10px;
    font-size: 12px;
    display: none;
    z-index: 2000;
}

/* ===== LEGEND ===== */
#legend {
    position: absolute;
    top: 80px;
    left: 10px;
    z-index: 500;
    display: flex;
    flex-direction: column;
    gap: 6px;
}

.legend-badge {
    font-size: 0.75rem;
    padding: 0.3em 0.6em;
    border-radius: 0.4rem;
}

/* ===== THERMAL ===== */
#thermal-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 1500px;
    height: 1356px;
    display: none;
    pointer-events: none;
    mix-blend-mode: overlay;
}

/* ===== FOOTER ===== */
footer {
    position: sticky;
    bottom: 0;
    width: 100%;
    padding: 0.4rem;
    font-size: 0.75rem;
    backdrop-filter: blur(16px);
    background: rgba(30,30,30,0.6);
    border-top: 2px solid #88ff00;
    color: #88ff00;
    text-align: center;
}
</style>
</head>

<body>

<nav class="navbar navbar-glass d-flex justify-content-between align-items-center">
    <span class="navbar-brand"><i class="fa-solid fa-map"></i> Sebs DayZ Map</span>
    <button class="btn btn-success btn-sm" id="toggle-thermal">
        <i class="fa-solid fa-fire"></i> Thermal
    </button>
</nav>

<div id="viewport">
    <div id="map-wrapper">
        <div id="map-container"></div>
        <canvas id="thermal-overlay" width="1500" height="1356"></canvas>
    </div>
    <div id="legend"></div>
</div>

<div id="tooltip"></div>

<footer>Designed by Seb, 2026</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<script>
/* ===== DATA ===== */
const locations = [
  {n:'Balota',x:453,y:1188,t:'Village'},
  {n:'Chernogorsk',x:621,y:1176,t:'City'},
  {n:'Elektrozavodsk',x:971,y:1224,t:'City'},
  {n:'NWAF',x:418,y:453,t:'Airfield'},
  {n:'Tisy Military Base',x:157,y:139,t:'Military'}
];

const colors = {
  City:'#1e90ff',
  Town:'#00ffff',
  Village:'#00ff66',
  Military:'#ff3333',
  Airfield:'#ffa500'
};

/* ===== MARKERS ===== */
const map = document.getElementById('map-container');
const tooltip = document.getElementById('tooltip');

locations.forEach(l=>{
    const m = document.createElement('div');
    m.className = 'marker';
    m.style.left = l.x + 'px';
    m.style.top = l.y + 'px';
    m.style.background = colors[l.t];

    m.addEventListener('mouseenter', e=>{
        tooltip.style.display='block';
        tooltip.innerHTML=`<strong>${l.n}</strong><br>${l.t}`;
    });
    m.addEventListener('mousemove', e=>{
        tooltip.style.left = e.clientX + 12 + 'px';
        tooltip.style.top = e.clientY + 12 + 'px';
    });
    m.addEventListener('mouseleave', ()=>tooltip.style.display='none');

    map.appendChild(m);
});

/* ===== LEGEND ===== */
const legend = document.getElementById('legend');
Object.entries(colors).forEach(([k,v])=>{
    const s = document.createElement('span');
    s.className='badge legend-badge';
    s.style.background=v;
    s.textContent=k;
    legend.appendChild(s);
});

/* ===== ZOOM + PAN (DESKTOP + MOBILE SAFE) ===== */
const wrapper = document.getElementById('map-wrapper');
const viewport = document.getElementById('viewport');

let scale = 1;
let originX = 0, originY = 0;
let dragging = false;
let startX = 0, startY = 0;

/* Desktop pan */
viewport.addEventListener('mousedown', e=>{
    dragging = true;
    startX = e.clientX - originX;
    startY = e.clientY - originY;
});
window.addEventListener('mouseup', ()=>dragging=false);
window.addEventListener('mousemove', e=>{
    if(!dragging) return;
    originX = e.clientX - startX;
    originY = e.clientY - startY;
    update();
});

/* Desktop zoom */
viewport.addEventListener('wheel', e=>{
    e.preventDefault();
    const zoom = e.deltaY < 0 ? 1.1 : 0.9;
    scale = Math.min(4, Math.max(0.6, scale * zoom));
    update();
},{passive:false});

/* Touch support */
let lastDist = 0;
viewport.addEventListener('touchstart', e=>{
    if(e.touches.length === 1){
        startX = e.touches[0].clientX - originX;
        startY = e.touches[0].clientY - originY;
    }
    if(e.touches.length === 2){
        const dx = e.touches[0].clientX - e.touches[1].clientX;
        const dy = e.touches[0].clientY - e.touches[1].clientY;
        lastDist = Math.hypot(dx,dy);
    }
},{passive:false});

viewport.addEventListener('touchmove', e=>{
    e.preventDefault();
    if(e.touches.length === 1){
        originX = e.touches[0].clientX - startX;
        originY = e.touches[0].clientY - startY;
    }
    if(e.touches.length === 2){
        const dx = e.touches[0].clientX - e.touches[1].clientX;
        const dy = e.touches[0].clientY - e.touches[1].clientY;
        const dist = Math.hypot(dx,dy);
        scale = Math.min(4, Math.max(0.6, scale * (dist / lastDist)));
        lastDist = dist;
    }
    update();
},{passive:false});

function update(){
    wrapper.style.transform = `translate(${originX}px, ${originY}px) scale(${scale})`;
}

/* ===== CENTER MAP ===== */
function centerMap(){
    const r = viewport.getBoundingClientRect();
    originX = (r.width - 1500 * scale)/2;
    originY = (r.height - 1356 * scale)/2;
    update();
}
window.addEventListener('load', centerMap);
window.addEventListener('resize', centerMap);

/* ===== THERMAL ===== */
const canvas = document.getElementById('thermal-overlay');
const ctx = canvas.getContext('2d');
const thermalBtn = document.getElementById('toggle-thermal');
let thermalOn = false;

function drawThermal(){
    ctx.clearRect(0,0,1500,1356);
    locations.forEach(l=>{
        const g = ctx.createRadialGradient(l.x,l.y,0,l.x,l.y,80);
        g.addColorStop(0,'rgba(255,0,0,0.3)');
        g.addColorStop(1,'rgba(255,0,0,0)');
        ctx.fillStyle = g;
        ctx.fillRect(l.x-80,l.y-80,160,160);
    });
}

thermalBtn.onclick = ()=>{
    thermalOn = !thermalOn;
    canvas.style.display = thermalOn ? 'block' : 'none';
    if(thermalOn) drawThermal();
};
</script>

</body>
</html>
