<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CHERNOMAP – Full Calibration</title>

<style>
body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: #111;
    color: #fff;
    display: flex;
    flex-direction: column;
    align-items: center;
}

h1 {
    margin: 10px 0;
}

/* MAP */
#map-container {
    position: relative;
    width: 1500px;
    height: 1356px;
    background: url('CHERNOMAP.webp') no-repeat top left;
    background-size: cover;
    border: 2px solid #fff;
    cursor: crosshair;
}

/* CROSSHAIR */
.cross-x, .cross-y {
    position: absolute;
    pointer-events: none;
    background: rgba(255,255,255,0.35);
    z-index: 5;
}
.cross-x { height: 1px; width: 100%; }
.cross-y { width: 1px; height: 100%; }

/* PIN */
.pin {
    position: absolute;
    width: 10px;
    height: 10px;
    background: red;
    border-radius: 50%;
    transform: translate(-50%, -50%);
    pointer-events: none;
}

/* PANEL */
#panel {
    width: 520px;
    margin: 15px 0;
    background: #1a1a1a;
    border: 1px solid #444;
    padding: 12px;
}

#panel h2 {
    text-align: center;
    margin: 0 0 8px 0;
}

#instruction, #progress, #coords {
    text-align: center;
    margin-bottom: 6px;
}

#coords {
    font-family: monospace;
}

button {
    padding: 6px 10px;
    margin: 4px;
    cursor: pointer;
}

textarea {
    width: 100%;
    height: 260px;
    background: #000;
    color: #0f0;
    font-family: monospace;
    margin-top: 8px;
}
</style>
</head>

<body>

<h1>CHERNOMAP – FULL SETTLEMENT CALIBRATION</h1>

<div id="map-container">
    <div class="cross-x" id="crossX"></div>
    <div class="cross-y" id="crossY"></div>
</div>

<div id="panel">
    <h2>Calibration Panel</h2>
    <div id="progress">Idle</div>
    <div id="instruction">Press Start</div>
    <div id="coords">X: — | Y: —</div>

    <button id="start">Start</button>
    <button id="undo" disabled>Undo</button>
    <button id="copy" disabled>Copy Results</button>

    <textarea id="output" readonly></textarea>
</div>

<script>
/* ===== COMPLETE CHERNARUS LOCATION LIST ===== */
const locations = [
/* CITIES */
'Chernogorsk','Elektrozavodsk','Berezino','Zelenogorsk','Novaya Petrovka','Novodmitrovsk',

/* TOWNS */
'Severograd','Vybor','Grishino','Gorka','Solnichniy','Staroye','Mogilevka',
'Krasnostav','Svetlojarsk','Nadezhdino','Kozlovka','Pavlovo',

/* VILLAGES */
'Balota','Bor','Drozhino','Dubrovka','Guglovo','Kabanino','Kamyshovo',
'Khelm','Komarovo','Lopatino','Msta','Myshkino','Orlovets','Petrovka',
'Polana','Prigorodki','Pulkovo','Pusta','Rogovo','Shakhovka',
'Sosnovka','Stary Sobor','Novy Sobor','Tulga','Vyshnoye',
'Chernaya Polyana','Zvir','Sinystok','Topolniki','Kalinovka',

/* MILITARY */
'Tisy Military Base','Pavlovo Military','Kamensk Military','Myshkino Tents',
'Zelenogorsk Military','Stary Sobor Military','Novy Sobor Military',

/* AIRFIELDS */
'Northwest Airfield (NWAF)','Balota Airfield','Krasnostav Airstrip'
];

/* SORT FOR CONSISTENCY */
const calibrationList = locations.sort();

/* ===== STATE ===== */
let index = -1;
let active = false;
let results = [];
let pins = [];

/* ===== ELEMENTS ===== */
const map = document.getElementById('map-container');
const crossX = document.getElementById('crossX');
const crossY = document.getElementById('crossY');
const instruction = document.getElementById('instruction');
const progress = document.getElementById('progress');
const coords = document.getElementById('coords');
const output = document.getElementById('output');
const startBtn = document.getElementById('start');
const undoBtn = document.getElementById('undo');
const copyBtn = document.getElementById('copy');

/* ===== CROSSHAIR ===== */
map.addEventListener('mousemove', e => {
    const r = map.getBoundingClientRect();
    const x = Math.round(e.clientX - r.left);
    const y = Math.round(e.clientY - r.top);

    crossX.style.top = y + 'px';
    crossY.style.left = x + 'px';
    coords.textContent = `X: ${x} | Y: ${y}`;
});

/* ===== START ===== */
startBtn.addEventListener('click', () => {
    active = true;
    index = 0;
    results = [];
    output.value = '';
    pins.forEach(p => p.remove());
    pins = [];

    instruction.textContent = `Click on: ${calibrationList[index]}`;
    progress.textContent = `1 / ${calibrationList.length}`;
    undoBtn.disabled = false;
    copyBtn.disabled = true;
});

/* ===== CLICK RECORD ===== */
map.addEventListener('click', e => {
    if (!active) return;

    const r = map.getBoundingClientRect();
    const x = Math.round(e.clientX - r.left);
    const y = Math.round(e.clientY - r.top);

    const name = calibrationList[index];
    results.push({ name, x, y });
    output.value += `${name}: ${x},${y}\n`;

    const pin = document.createElement('div');
    pin.className = 'pin';
    pin.style.left = x + 'px';
    pin.style.top = y + 'px';
    map.appendChild(pin);
    pins.push(pin);

    index++;

    if (index < calibrationList.length) {
        instruction.textContent = `Click on: ${calibrationList[index]}`;
        progress.textContent = `${index + 1} / ${calibrationList.length}`;
    } else {
        instruction.textContent = 'Calibration complete ✔';
        progress.textContent = `${calibrationList.length} / ${calibrationList.length}`;
        active = false;
        copyBtn.disabled = false;
    }
});

/* ===== UNDO ===== */
undoBtn.addEventListener('click', () => {
    if (results.length === 0) return;
    results.pop();
    pins.pop().remove();
    index--;
    output.value = results.map(r => `${r.name}: ${r.x},${r.y}`).join('\n') + '\n';
    instruction.textContent = `Click on: ${calibrationList[index]}`;
    progress.textContent = `${index + 1} / ${calibrationList.length}`;
});

/* ===== COPY ===== */
copyBtn.addEventListener('click', () => {
    navigator.clipboard.writeText(output.value);
    copyBtn.textContent = 'Copied!';
    setTimeout(() => copyBtn.textContent = 'Copy Results', 1500);
});
</script>

</body>
</html>
