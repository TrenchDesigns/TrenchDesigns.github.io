<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sebs DayZ Map — V300000 PRO</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
<style>
html,body{margin:0;padding:0;width:100%;height:100%;overflow:hidden;background:#111;color:#fff;font-family:'Segoe UI',Roboto,sans-serif;}
.navbar-glass{backdrop-filter:blur(18px) saturate(180%);background:rgba(20,20,20,0.65);border-bottom:2px solid #88ff00;padding:.45rem 1rem;box-shadow:0 10px 25px rgba(0,0,0,0.5);}
.navbar-brand{font-weight:800;color:#88ff00;letter-spacing:.5px;}
#viewport{position:relative;width:100%;height:calc(100vh - 110px);touch-action:none;user-select:none;}
#legend{position:absolute;top:90px;left:12px;z-index:500;display:flex;flex-direction:column;gap:6px;}
.legend-badge{font-size:.72rem;padding:.35em .6em;border-radius:.45rem;}
#tooltip{position:absolute;background:rgba(0,0,0,0.85);padding:6px 10px;border-radius:10px;font-size:12px;display:none;pointer-events:none;z-index:3000;}
footer{position:sticky;bottom:0;width:100%;padding:.35rem;font-size:.72rem;background:rgba(20,20,20,0.65);border-top:2px solid #88ff00;color:#88ff00;text-align:center;}
canvas{display:block;position:absolute;top:0;left:0;}
</style>
</head>
<body>

<nav class="navbar navbar-glass d-flex justify-content-between align-items-center">
    <span class="navbar-brand"><i class="fa-solid fa-map"></i> Sebs DayZ Map</span>
    <div class="d-flex gap-2 align-items-center">
        <input id="searchBox" class="form-control form-control-sm" placeholder="Search POI…">
        <button class="btn btn-success btn-sm" id="toggle-thermal"><i class="fa-solid fa-fire"></i></button>
    </div>
</nav>

<div id="viewport">
    <canvas id="mapCanvas" width="1500" height="1356"></canvas>
    <canvas id="thermalCanvas" width="1500" height="1356" style="display:none;"></canvas>
    <div id="legend"></div>
    <div id="tooltip"></div>
</div>

<footer>Sebs DayZ Map — V300000 PRO</footer>

<script>
// ===== DATA =====
const locations=[ /* include all your previous locations here */ ];
const colors={City:'#1e90ff',Town:'#00ffff',Village:'#00ff66',Military:'#ff3333',Airfield:'#ffa500'};
const hotspotWeights={'Northwest Airfield (NWAF)':5,'Tisy Military Base':5,'Balota Airfield':4,'Chernogorsk':4,'Elektrozavodsk':4,'Zelenogorsk':3,'Stary Sobor':3,'Novy Sobor':3,'Vybor':3,'Berezino':3};

// ===== ELEMENTS =====
const viewport=document.getElementById('viewport');
const mapCanvas=document.getElementById('mapCanvas');
const thermalCanvas=document.getElementById('thermalCanvas');
const mapCtx=mapCanvas.getContext('2d');
const thermalCtx=thermalCanvas.getContext('2d');
const tooltip=document.getElementById('tooltip');

// ===== STATE =====
let scale=1,translateX=0,translateY=0;
let dragging=false,lastX=0,lastY=0;
let pinchStart=0,pinchScale=1,pinchCenter={x:0,y:0};
let thermalOn=false;

// ===== LEGEND =====
const legend=document.getElementById('legend');
Object.entries(colors).forEach(([k,v])=>{
    const s=document.createElement('span');
    s.className='badge legend-badge';
    s.style.background=v;
    s.textContent=k;
    legend.appendChild(s);
});

// ===== DRAW =====
const mapImg=new Image();
mapImg.src='CHERNOMAP.webp';
mapImg.onload=()=>draw();

function draw(){
    mapCtx.clearRect(0,0,mapCanvas.width,mapCanvas.height);
    mapCtx.save();
    mapCtx.translate(translateX,translateY);
    mapCtx.scale(scale,scale);
    mapCtx.drawImage(mapImg,0,0,mapCanvas.width,mapCanvas.height);
    locations.forEach(loc=>{
        mapCtx.beginPath();
        mapCtx.fillStyle=colors[loc.t];
        const r=8;
        mapCtx.arc(loc.x,loc.y,r,0,Math.PI*2);
        mapCtx.fill();
    });
    mapCtx.restore();
    if(thermalOn) drawThermal();
}

function drawThermal(){
    thermalCtx.clearRect(0,0,thermalCanvas.width,thermalCanvas.height);
    thermalCtx.save();
    thermalCtx.translate(translateX,translateY);
    thermalCtx.scale(scale,scale);
    locations.forEach(l=>{
        const w=hotspotWeights[l.n]||1,radius=50+20*w,alpha=0.1+0.1*w;
        const grad=thermalCtx.createRadialGradient(l.x,l.y,0,l.x,l.y,radius);
        grad.addColorStop(0,'rgba(255,0,0,'+alpha+')');
        grad.addColorStop(1,'rgba(255,0,0,0)');
        thermalCtx.fillStyle=grad;
        thermalCtx.fillRect(l.x-radius,l.y-radius,radius*2,radius*2);
    });
    thermalCtx.restore();
}

// ===== POINTER HELPER =====
function screenToMap(x,y){
    return {x:(x-translateX)/scale, y:(y-translateY)/scale};
}

// ===== TOOLTIP =====
viewport.addEventListener('mousemove',e=>{
    const m=screenToMap(e.offsetX,e.offsetY);
    const hit=locations.find(l=>Math.hypot(l.x-m.x,l.y-m.y)<12);
    if(hit){
        tooltip.style.display='block';
        tooltip.style.left=e.clientX+12+'px';
        tooltip.style.top=e.clientY+12+'px';
        tooltip.innerHTML=`<strong>${hit.n}</strong><br>${hit.t}`;
    } else tooltip.style.display='none';
});

// ===== DRAG =====
viewport.addEventListener('mousedown',e=>{dragging=true; lastX=e.clientX; lastY=e.clientY;});
window.addEventListener('mouseup',()=>dragging=false);
window.addEventListener('mousemove',e=>{
    if(!dragging) return;
    translateX += e.clientX - lastX;
    translateY += e.clientY - lastY;
    lastX = e.clientX;
    lastY = e.clientY;
    draw();
});

// ===== WHEEL ZOOM =====
viewport.addEventListener('wheel',e=>{
    e.preventDefault();
    const rect=viewport.getBoundingClientRect();
    const cx=e.clientX-rect.left,cy=e.clientY-rect.top;
    const prevScale=scale;
    scale *= e.deltaY<0?1.12:0.88;
    scale=Math.min(4,Math.max(0.5,scale));
    translateX -= (cx-translateX)*(scale/prevScale -1);
    translateY -= (cy-translateY)*(scale/prevScale -1);
    draw();
},{passive:false});

// ===== TOUCH =====
viewport.addEventListener('touchstart',e=>{
    if(e.touches.length===2){
        const t1=e.touches[0],t2=e.touches[1];
        pinchStart=Math.hypot(t1.clientX-t2.clientX,t1.clientY-t2.clientY);
        pinchScale=scale;
        const rect=viewport.getBoundingClientRect();
        pinchCenter.x=(t1.clientX+t2.clientX)/2-rect.left;
        pinchCenter.y=(t1.clientY+t2.clientY)/2-rect.top;
    } else if(e.touches.length===1){
        lastX=e.touches[0].clientX-translateX;
        lastY=e.touches[0].clientY-translateY;
    }
},{passive:false});

viewport.addEventListener('touchmove',e=>{
    e.preventDefault();
    if(e.touches.length===1){
        translateX=e.touches[0].clientX-lastX;
        translateY=e.touches[0].clientY-lastY;
    } else if(e.touches.length===2){
        const t1=e.touches[0],t2=e.touches[1];
        const d=Math.hypot(t1.clientX-t2.clientX,t1.clientY-t2.clientY);
        const prevScale=scale;
        scale=Math.min(4,Math.max(0.5,pinchScale*d/pinchStart));
        translateX -= (pinchCenter.x/prevScale)*(scale-prevScale);
        translateY -= (pinchCenter.y/prevScale)*(scale-prevScale);
    }
    draw();
},{passive:false});

// ===== SMOOTH ZOOM TO POI =====
function smoothZoomTo(x,y,target){
    const steps=25,interval=15;
    const startScale=scale,startX=translateX,startY=translateY;
    const targetX=viewport.clientWidth/2 - x*target;
    const targetY=viewport.clientHeight/2 - y*target;
    let step=0;
    const anim=setInterval(()=>{
        step++;
        const t=step/steps;
        scale=startScale + (target-startScale)*t;
        translateX=startX + (targetX-startX)*t;
        translateY=startY + (targetY-startY)*t;
        draw();
        if(step>=steps) clearInterval(anim);
    },interval);
}

// ===== SEARCH =====
document.getElementById('searchBox').addEventListener('keydown',e=>{
    if(e.key!=='Enter') return;
    const q=e.target.value.toLowerCase();
    const l=locations.find(l=>l.n.toLowerCase().includes(q));
    if(l) smoothZoomTo(l.x,l.y,2.5);
});

// ===== THERMAL =====
document.getElementById('toggle-thermal').onclick=()=>{
    thermalOn=!thermalOn;
    thermalCanvas.style.display=thermalOn?'block':'none';
    draw();
};

// ===== INIT =====
function centerMap(){
    scale=1;
    translateX=(viewport.clientWidth-mapCanvas.width)/2;
    translateY=(viewport.clientHeight-mapCanvas.height)/2;
    draw();
}
window.addEventListener('resize',centerMap);
centerMap();
</script>

</body>
</html>
