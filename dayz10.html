<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sebs DayZ Map — V100000+++ PRO</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
<style>
html,body{margin:0;padding:0;width:100%;height:100%;overflow:hidden;background:#111;color:#fff;font-family:'Segoe UI',Roboto,sans-serif;}
.navbar-glass{backdrop-filter:blur(18px) saturate(180%);background:rgba(20,20,20,0.65);border-bottom:2px solid #88ff00;padding:.45rem 1rem;box-shadow:0 10px 25px rgba(0,0,0,0.5);}
.navbar-brand{font-weight:800;color:#88ff00;letter-spacing:.5px;}
#viewport{position:relative;width:100%;height:calc(100vh - 110px);overflow:hidden;touch-action:none;cursor:grab;}
#viewport:active{cursor:grabbing;}
#map-wrapper{position:absolute;width:1500px;height:1356px;transform-origin:0 0;will-change:transform;}
#map-container{width:1500px;height:1356px;background:url('CHERNOMAP.webp') no-repeat top left;background-size:contain;}
.marker{position:absolute;width:16px;height:16px;border-radius:50%;transform:translate(-50%,-50%);transition:transform .15s ease,box-shadow .2s ease;cursor:pointer;}
.marker:hover{box-shadow:0 0 12px rgba(255,255,255,.6);}
.marker.hidden{opacity:0;pointer-events:none;}
#tooltip{position:fixed;background:rgba(0,0,0,0.85);padding:6px 10px;border-radius:10px;font-size:12px;display:none;z-index:3000;pointer-events:none;}
#legend{position:absolute;top:90px;left:12px;z-index:500;display:flex;flex-direction:column;gap:6px;}
.legend-badge{font-size:.72rem;padding:.35em .6em;border-radius:.45rem;}
#thermal-overlay{position:absolute;top:0;left:0;width:1500px;height:1356px;pointer-events:none;display:none;mix-blend-mode:overlay;}
footer{position:sticky;bottom:0;width:100%;padding:.35rem;font-size:.72rem;background:rgba(20,20,20,0.65);border-top:2px solid #88ff00;color:#88ff00;text-align:center;}
</style>
</head>
<body>

<nav class="navbar navbar-glass d-flex justify-content-between align-items-center">
    <span class="navbar-brand"><i class="fa-solid fa-map"></i> Sebs DayZ Map</span>
    <div class="d-flex gap-2 align-items-center">
        <input id="searchBox" class="form-control form-control-sm" placeholder="Search POI…">
        <button class="btn btn-success btn-sm" id="toggle-thermal"><i class="fa-solid fa-fire"></i></button>
    </div>
</nav>

<div id="viewport">
    <div id="map-wrapper">
        <div id="map-container"></div>
        <canvas id="thermal-overlay" width="1500" height="1356"></canvas>
    </div>
    <div id="legend"></div>
</div>

<div id="tooltip"></div>
<footer>Sebs DayZ Map — V100000+++ PRO</footer>

<script>
// ===== DATA =====
const locations=[ /* keep all your locations here */ ];
const colors={City:'#1e90ff',Town:'#00ffff',Village:'#00ff66',Military:'#ff3333',Airfield:'#ffa500'};
const hotspotWeights={'Northwest Airfield (NWAF)':5,'Tisy Military Base':5,'Balota Airfield':4,'Chernogorsk':4,'Elektrozavodsk':4,'Zelenogorsk':3,'Stary Sobor':3,'Novy Sobor':3,'Vybor':3,'Berezino':3};

// ===== ELEMENTS =====
const viewport=document.getElementById('viewport');
const wrapper=document.getElementById('map-wrapper');
const map=document.getElementById('map-container');
const tooltip=document.getElementById('tooltip');
const markers=[];

// ===== CREATE MARKERS =====
locations.forEach(l=>{
  const m=document.createElement('div');
  m.className='marker';
  m.style.left=l.x+'px';
  m.style.top=l.y+'px';
  m.style.background=colors[l.t];
  m.dataset.type=l.t;
  m.dataset.name=l.n.toLowerCase();
  m.addEventListener('mouseenter',()=>{tooltip.style.display='block';tooltip.innerHTML=`<strong>${l.n}</strong><br>${l.t}`;});
  m.addEventListener('mousemove',e=>{tooltip.style.left=e.clientX+12+'px';tooltip.style.top=e.clientY+12+'px';});
  m.addEventListener('mouseleave',()=>tooltip.style.display='none');
  m.addEventListener('click',()=>smoothZoomTo(l.x,l.y,2.6));
  map.appendChild(m);
  markers.push(m);
});

// ===== LEGEND =====
const legend=document.getElementById('legend');
Object.entries(colors).forEach(([k,v])=>{
  const s=document.createElement('span');
  s.className='badge legend-badge';
  s.style.background=v;
  s.textContent=k;
  legend.appendChild(s);
});

// ===== TRANSFORM STATE =====
let scale=1,originX=0,originY=0;
let dragging=false,lastX=0,lastY=0,velX=0,velY=0;
const mapW=1500,mapH=1356;

// ===== HELPER: CLAMP =====
function clampOrigin(){
  const vw=viewport.clientWidth,vh=viewport.clientHeight;
  const mw=mapW*scale,mh=mapH*scale;
  originX=Math.min(0,Math.max(vw-mw,originX));
  originY=Math.min(0,Math.max(vh-mh,originY));
}

// ===== UPDATE MAP =====
function update(){
  clampOrigin();
  wrapper.style.transform=`translate(${originX}px,${originY}px) scale(${scale})`;
  markers.forEach(m=>{
    if(scale<0.85 && m.dataset.type==='Village') m.classList.add('hidden'); else m.classList.remove('hidden');
    m.style.transform=`translate(-50%,-50%) scale(${1/scale})`;
  });
}

// ===== MOUSE DRAG =====
viewport.addEventListener('mousedown',e=>{
  dragging=true; lastX=e.clientX-originX; lastY=e.clientY-originY;
  velX=velY=0;
});
window.addEventListener('mouseup',()=>dragging=false);
window.addEventListener('mousemove',e=>{
  if(!dragging) return;
  const newX=e.clientX-lastX,newY=e.clientY-lastY;
  velX=newX-originX; velY=newY-originY;
  originX=newX; originY=newY;
  update();
});

// ===== INERTIA LOOP =====
function inertiaLoop(){
  if(!dragging){
    originX+=velX; originY+=velY;
    velX*=0.85; velY*=0.85;
    if(Math.abs(velX)+Math.abs(velY)<0.1){velX=0; velY=0;}
    update();
  }
  requestAnimationFrame(inertiaLoop);
}
inertiaLoop();

// ===== WHEEL ZOOM =====
viewport.addEventListener('wheel',e=>{
 e.preventDefault();
 const rect=viewport.getBoundingClientRect();
 const cx=e.clientX-rect.left,cy=e.clientY-rect.top;
 const prevScale=scale;
 scale*=e.deltaY<0?1.12:0.88;
 scale=Math.min(4,Math.max(0.6,scale));
 originX-=(cx/prevScale)*(scale-prevScale);
 originY-=(cy/prevScale)*(scale-prevScale);
 update();
},{passive:false});

// ===== TOUCH ZOOM / PAN =====
let pinchStart=0,pinchScale=1,pinchCenter={x:0,y:0};
viewport.addEventListener('touchstart',e=>{
 if(e.touches.length===2){
   const t1=e.touches[0],t2=e.touches[1];
   pinchStart=Math.hypot(t1.clientX-t2.clientX,t1.clientY-t2.clientY);
   pinchScale=scale;
   const r=viewport.getBoundingClientRect();
   pinchCenter.x=(t1.clientX+t2.clientX)/2-r.left;
   pinchCenter.y=(t1.clientY+t2.clientY)/2-r.top;
 } else if(e.touches.length===1){
   lastX=e.touches[0].clientX-originX; lastY=e.touches[0].clientY-originY;
   velX=velY=0;
 }
},{passive:false});
viewport.addEventListener('touchmove',e=>{
 e.preventDefault();
 if(e.touches.length===1){
   const t=e.touches[0];
   velX=t.clientX-originX-lastX; velY=t.clientY-originY-lastY;
   originX=t.clientX-lastX; originY=t.clientY-lastY;
 }
 if(e.touches.length===2){
   const t1=e.touches[0],t2=e.touches[1];
   const d=Math.hypot(t1.clientX-t2.clientX,t1.clientY-t2.clientY);
   const prevScale=scale;
   scale=Math.min(4,Math.max(0.6,pinchScale*d/pinchStart));
   originX-=(pinchCenter.x/pinchScale)*(scale-prevScale);
   originY-=(pinchCenter.y/pinchScale)*(scale-prevScale);
 }
 update();
},{passive:false});

// ===== SMOOTH ZOOM TO =====
function smoothZoomTo(x,y,target){
  const startScale=scale;
  const startX=originX,startY=originY;
  const targetX=viewport.clientWidth/2-x*target;
  const targetY=viewport.clientHeight/2-y*target;
  const steps=25,interval=15;
  let step=0;
  const anim=setInterval(()=>{
    step++;
    const t=step/steps;
    scale=startScale+(target-startScale)*t;
    originX=startX+(targetX-startX)*t;
    originY=startY+(targetY-startY)*t;
    update();
    if(step>=steps) clearInterval(anim);
  },interval);
}

// ===== SEARCH =====
document.getElementById('searchBox').addEventListener('keydown',e=>{
 if(e.key!=='Enter')return;
 const q=e.target.value.toLowerCase();
 const l=locations.find(l=>l.n.toLowerCase().includes(q));
 if(l) smoothZoomTo(l.x,l.y,2.6);
});

// ===== THERMAL =====
const canvas=document.getElementById('thermal-overlay'),ctx=canvas.getContext('2d');
let thermalOn=false;
document.getElementById('toggle-thermal').onclick=()=>{
 thermalOn=!thermalOn;
 canvas.style.display=thermalOn?'block':'none';
 if(thermalOn) drawThermal();
};
function drawThermal(){
 ctx.clearRect(0,0,1500,1356);
 locations.forEach(l=>{
   const w=hotspotWeights[l.n]||1,r=50+20*w,a=0.1+0.1*w;
   const g=ctx.createRadialGradient(l.x,l.y,0,l.x,l.y,r);
   g.addColorStop(0,'rgba(255,0,0,'+a+')'); g.addColorStop(1,'rgba(255,0,0,0)');
   ctx.fillStyle=g;
   ctx.fillRect(l.x-r,l.y-r,r*2,r*2);
 });
}

// ===== INIT =====
function centerMap(){scale=1;originX=(viewport.clientWidth-mapW)/2;originY=(viewport.clientHeight-mapH)/2;update();}
window.addEventListener('resize',centerMap);
centerMap();
</script>
</body>
</html>
